# Rails 8.0.2.1 Docker Environment

This is a Docker setup for Rails 8.0.2.1 application development.

## Requirements

- Docker
- Docker Compose

## Getting Started

### Option 1: Simple Setup (Recommended for quick start)

```bash
# Clone this repository
git clone https://github.com/akio-kikui/rails_8021.git
cd rails_8021

# Start with simple setup
docker compose -f docker-compose.simple.yml up
```

### Option 2: Build-based Setup

```bash
# Build and start the application  
docker compose up --build
```

The application will be available at `http://localhost:3000`

## Development

### Starting the application
```bash
# Simple setup
docker compose -f docker-compose.simple.yml up

# Or build-based setup
docker compose up
```

### Running Rails commands
```bash
# Generate a new controller (simple setup)
docker compose -f docker-compose.simple.yml exec web rails generate controller Welcome index

# Generate a new controller (build-based setup)
docker compose exec web rails generate controller Welcome index

# Run migrations
docker compose exec web rails db:migrate

# Access Rails console
docker compose exec web rails console

# Run tests
docker compose exec web rails test
```

### Stopping the application
```bash
docker compose down
# or
docker compose -f docker-compose.simple.yml down
```

### Rebuilding after dependency changes
```bash
docker compose down
docker compose up --build
```

## Technical Details

- **Ruby version**: 3.2.3
- **Rails version**: 8.0.2.1
- **Database**: PostgreSQL 16
- **CSS Framework**: Bootstrap (via cssbundling-rails)
- **JavaScript**: ImportMap

## Docker Files

- `Dockerfile`: Production-ready image (generated by Rails)
- `Dockerfile.dev`: Development-friendly image
- `docker-compose.yml`: Development environment with PostgreSQL (build-based)
- `docker-compose.simple.yml`: Simple development environment (no build required)
- `.dockerignore`: Files to exclude from Docker build context

## Database Configuration

The application is configured to use PostgreSQL running in a Docker container. The database connection details are:

- Host: db (Docker service name)
- Database: rails_8021_development
- Username: postgres
- Password: password
- Port: 5432

## Troubleshooting

If you encounter SSL certificate issues when building Docker images, use the simple setup with `docker-compose.simple.yml` which bypasses the build step and installs dependencies at runtime.
